{"ast":null,"code":"import { io } from 'socket.io-client';\nimport { API_URL } from '../config/api';\nlet socket;\nlet reconnectTimer;\nexport const initSocket = token => {\n  if (socket) {\n    socket.disconnect();\n  }\n  socket = io(API_URL, {\n    auth: {\n      token\n    },\n    reconnection: true,\n    reconnectionAttempts: 5,\n    reconnectionDelay: 1000,\n    reconnectionDelayMax: 5000,\n    timeout: 20000\n  });\n  socket.on('connect', () => {\n    console.log('Connected to WebSocket server');\n    if (reconnectTimer) {\n      clearTimeout(reconnectTimer);\n      reconnectTimer = null;\n    }\n  });\n  socket.on('connect_error', error => {\n    console.error('Socket connection error:', error);\n    if (!reconnectTimer) {\n      reconnectTimer = setTimeout(() => {\n        console.log('Attempting to reconnect...');\n        initSocket(token);\n      }, 5000);\n    }\n  });\n  socket.on('reconnect', attempt => {\n    console.log('Reconnected on attempt:', attempt);\n  });\n  socket.on('reconnect_error', error => {\n    console.error('Socket reconnection error:', error);\n  });\n  socket.on('reconnect_failed', () => {\n    console.error('Socket reconnection failed');\n  });\n  return socket;\n};\nexport const getSocket = () => {\n  if (!socket) {\n    throw new Error('Socket not initialized');\n  }\n  return socket;\n};","map":{"version":3,"names":["io","API_URL","socket","reconnectTimer","initSocket","token","disconnect","auth","reconnection","reconnectionAttempts","reconnectionDelay","reconnectionDelayMax","timeout","on","console","log","clearTimeout","error","setTimeout","attempt","getSocket","Error"],"sources":["D:/nodjsProjet/task-client/src/services/socketService.js"],"sourcesContent":["import { io } from 'socket.io-client';\r\nimport { API_URL } from '../config/api';\r\n\r\nlet socket;\r\nlet reconnectTimer;\r\n\r\nexport const initSocket = (token) => {\r\n    if (socket) {\r\n        socket.disconnect();\r\n    }\r\n\r\n    socket = io(API_URL, {\r\n        auth: { token },\r\n        reconnection: true,\r\n        reconnectionAttempts: 5,\r\n        reconnectionDelay: 1000,\r\n        reconnectionDelayMax: 5000,\r\n        timeout: 20000,\r\n    });\r\n\r\n    socket.on('connect', () => {\r\n        console.log('Connected to WebSocket server');\r\n        if (reconnectTimer) {\r\n            clearTimeout(reconnectTimer);\r\n            reconnectTimer = null;\r\n        }\r\n    });\r\n\r\n    socket.on('connect_error', (error) => {\r\n        console.error('Socket connection error:', error);\r\n        if (!reconnectTimer) {\r\n            reconnectTimer = setTimeout(() => {\r\n                console.log('Attempting to reconnect...');\r\n                initSocket(token);\r\n            }, 5000);\r\n        }\r\n    });\r\n\r\n    socket.on('reconnect', (attempt) => {\r\n        console.log('Reconnected on attempt:', attempt);\r\n    });\r\n\r\n    socket.on('reconnect_error', (error) => {\r\n        console.error('Socket reconnection error:', error);\r\n    });\r\n\r\n    socket.on('reconnect_failed', () => {\r\n        console.error('Socket reconnection failed');\r\n    });\r\n\r\n    return socket;\r\n};\r\n\r\nexport const getSocket = () => {\r\n    if (!socket) {\r\n        throw new Error('Socket not initialized');\r\n    }\r\n    return socket;\r\n};\r\n"],"mappings":"AAAA,SAASA,EAAE,QAAQ,kBAAkB;AACrC,SAASC,OAAO,QAAQ,eAAe;AAEvC,IAAIC,MAAM;AACV,IAAIC,cAAc;AAElB,OAAO,MAAMC,UAAU,GAAIC,KAAK,IAAK;EACjC,IAAIH,MAAM,EAAE;IACRA,MAAM,CAACI,UAAU,CAAC,CAAC;EACvB;EAEAJ,MAAM,GAAGF,EAAE,CAACC,OAAO,EAAE;IACjBM,IAAI,EAAE;MAAEF;IAAM,CAAC;IACfG,YAAY,EAAE,IAAI;IAClBC,oBAAoB,EAAE,CAAC;IACvBC,iBAAiB,EAAE,IAAI;IACvBC,oBAAoB,EAAE,IAAI;IAC1BC,OAAO,EAAE;EACb,CAAC,CAAC;EAEFV,MAAM,CAACW,EAAE,CAAC,SAAS,EAAE,MAAM;IACvBC,OAAO,CAACC,GAAG,CAAC,+BAA+B,CAAC;IAC5C,IAAIZ,cAAc,EAAE;MAChBa,YAAY,CAACb,cAAc,CAAC;MAC5BA,cAAc,GAAG,IAAI;IACzB;EACJ,CAAC,CAAC;EAEFD,MAAM,CAACW,EAAE,CAAC,eAAe,EAAGI,KAAK,IAAK;IAClCH,OAAO,CAACG,KAAK,CAAC,0BAA0B,EAAEA,KAAK,CAAC;IAChD,IAAI,CAACd,cAAc,EAAE;MACjBA,cAAc,GAAGe,UAAU,CAAC,MAAM;QAC9BJ,OAAO,CAACC,GAAG,CAAC,4BAA4B,CAAC;QACzCX,UAAU,CAACC,KAAK,CAAC;MACrB,CAAC,EAAE,IAAI,CAAC;IACZ;EACJ,CAAC,CAAC;EAEFH,MAAM,CAACW,EAAE,CAAC,WAAW,EAAGM,OAAO,IAAK;IAChCL,OAAO,CAACC,GAAG,CAAC,yBAAyB,EAAEI,OAAO,CAAC;EACnD,CAAC,CAAC;EAEFjB,MAAM,CAACW,EAAE,CAAC,iBAAiB,EAAGI,KAAK,IAAK;IACpCH,OAAO,CAACG,KAAK,CAAC,4BAA4B,EAAEA,KAAK,CAAC;EACtD,CAAC,CAAC;EAEFf,MAAM,CAACW,EAAE,CAAC,kBAAkB,EAAE,MAAM;IAChCC,OAAO,CAACG,KAAK,CAAC,4BAA4B,CAAC;EAC/C,CAAC,CAAC;EAEF,OAAOf,MAAM;AACjB,CAAC;AAED,OAAO,MAAMkB,SAAS,GAAGA,CAAA,KAAM;EAC3B,IAAI,CAAClB,MAAM,EAAE;IACT,MAAM,IAAImB,KAAK,CAAC,wBAAwB,CAAC;EAC7C;EACA,OAAOnB,MAAM;AACjB,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}